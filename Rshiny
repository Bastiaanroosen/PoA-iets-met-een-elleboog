## app.R ##
library(shiny)
library(shinydashboard)
library(plotly)

#Jurgen 4) Als gebruiker wil ik kunnen zien wat de invloed is van de waterstanden op de ligtijd, 
#zodat ik weet of en zo ja wanneer ik er rekening mee moet houden dat boten een grotere kans hebben op vertraging.

ui <- dashboardPage(
  dashboardHeader(title = "POA Ligtijden"),
  dashboardSidebar(
    
    sidebarMenu(
      menuItem("Waterstanden vs ligtijden", icon = icon("dashboard"), tabName = "Waterstanden",
               badgeLabel = " ", badgeColor = "green"),
      menuItem("tab2", icon = icon("dashboard"), tabName = "tab2",
               badgeLabel = " ", badgeColor = "green"),
      menuItem("tab3", icon = icon("dashboard"), tabName = "tab3",
               badgeLabel = " ", badgeColor = "green")
      
    )
    
  ),
  dashboardBody(
    
    #tabs
    tabItems(
      #tab1
      tabItem(tabName = "Waterstanden",
              h2("Waterstanden vs ligtijden"),
              fluidRow(
                box(plotlyOutput("waterst")), box(plotlyOutput("ltijden"))
              ),
              
              fluidRow(box(sliderInput("month", "Data per maand", 1,10,1,1)))
      ),
      #tab2
      tabItem(tabName = "tab2",
              
              h2("tab2")
              
      ),
      #tab3
      tabItem(tabName = "tab3",
              
              h2("tab3")
              
      )
      
    )
    
    
  )
)

server <- function(input, output) {
  
  
  output$waterst <- renderPlotly({
    
    
    month <- switch(
      input$month,
      jan,
      feb,
      mar,
      apr,
      may,
      jun,
      jul,
      aug,
      sep,
      oct,
    )
    
    water  <- ggplot(month, aes(x= datumtijdstart, y= start_HAVENMEAN)) + geom_line()
  })
  
  output$ltijden <- renderPlotly({
    
    month <- switch(
      input$month,
      jan,
      feb,
      mar,
      apr,
      may,
      jun,
      jul,
      aug,
      sep,
      oct,
    )
    
    tijden  <- ggplot(month, aes(datumtijdstart, hoursberth)) + geom_point()
  })
}

shinyApp(ui, server)
