## app.R ##
library(shiny)
library(shinydashboard)

#Jurgen 4) Als gebruiker wil ik kunnen zien wat de invloed is van de waterstanden op de ligtijd, 
#zodat ik weet of en zo ja wanneer ik er rekening mee moet houden dat boten een grotere kans hebben op vertraging.

ui <- dashboardPage(
  dashboardHeader(title = "POA Ligtijden"),
  dashboardSidebar(
    
  ),
  dashboardBody(
    fluidRow(
      box(plotlyOutput("waterst")), box(plotlyOutput("ltijden"))
    ),
    
    fluidRow(box(sliderInput("month", "Data per maand", 1,10,1,1)))
  )
)

server <- function(input, output) {
  
  
  output$waterst <- renderPlotly({
    
   
    month <- switch(
      input$month,
      jan,
      feb,
      mar,
      apr,
      may,
      jun,
      jul,
      aug,
      sep,
      oct,
    )
    
    water  <- ggplot(month, aes(x= datumtijdstart, y= start_HAVENMEAN)) + geom_line()
  })
  
  output$ltijden <- renderPlotly({
    
    month <- switch(
      input$month,
      jan,
      feb,
      mar,
      apr,
      may,
      jun,
      jul,
      aug,
      sep,
      oct,
    )
    
    tijden  <- ggplot(month, aes(datumtijdstart, hoursberth)) + geom_point()
  })
}

shinyApp(ui, server)
